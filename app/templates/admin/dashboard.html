{% extends "admin/base.html" %}
{% block script %}
{#<script src=" https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js "></script>#}
<script src="{{ url_for('static', filename='vendor/chart.umd.min.js') }}"></script>
{#<script src="{{ url_for('static', filename='dashboard.js') }}"></script>#}

<script>
 const CollectionChart = document.getElementById('collection-chart');
 const labels = ['æ¨™ç±¤', 'æ¨™æœ¬', 'é¤¨è™Ÿ', 'å¤šåª’é«”æª”æ¡ˆ'];

 const parsed = JSON.parse({{ stats.collection_datasets_json | tojson }});

  new Chart(CollectionChart, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: parsed,
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          type: 'logarithmic',
          title: {
            display: true,
            text: '(logarithmic)'
          }
        }
      }
    }
  });

 const parsed2 = JSON.parse({{ stats.created_chart_json | tojson }});
 console.log(parsed2);
 const CreatedChart = document.getElementById('created-chart');
  new Chart(CreatedChart, {
    type: 'line',
    data: {
      labels: parsed2.labels,
      datasets: [{
        label: 'æ–°å¢æ¨™ç±¤æ•¸',
        data: parsed2.data,
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
      }],
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
        }
      }
    }
  });
</script>
{% endblock %}
{% block main %}
<div class="uk-container uk-container-expand">
  <div class="uk-grid uk-grid-divider uk-grid-medium uk-child-width-1-2 uk-child-width-1-4@l uk-child-width-1-5@xl" data-uk-grid="">
    <div class="uk-first-column">
      <span class="uk-text-small"><span data-uk-icon="icon:location" class="uk-margin-small-right uk-text-primary uk-icon"></span>æ¡é›†è¨˜éŒ„</span>
      <h1 class="uk-heading-primary uk-margin-remove  uk-text-primary">{{'{:,}'.format(stats.record_total) }}</h1>
      <div class="uk-text-small">
	{#åªæœ‰æ¡é›†è¨˜éŒ„ï¼Œæ²’æœ‰æ¨™æœ¬: {{ '{:,}'.format(stats.record_lack_unit_count) }} ç­†#}
      </div>
    </div>
    <div>
      <span class="uk-text-small"><span data-uk-icon="icon:album" class="uk-margin-small-right uk-text-primary uk-icon"></span>æ¨™æœ¬æ•¸é‡</span>
      <h1 class="uk-heading-primary uk-margin-remove uk-text-primary">{{ '{:,}'.format(stats.unit_total) }}</h1>
    </div>
    <div>
      <span class="uk-text-small"><span data-uk-icon="icon:tag" class="uk-margin-small-right uk-text-primary uk-icon"></span>é¤¨è™Ÿæ•¸é‡</span>
      <h1 class="uk-heading-primary uk-margin-remove uk-text-primary">{{ '{:,}'.format(stats.accession_number_total) }}</h1>
    </div>
    <div>
      <span class="uk-text-small"><span data-uk-icon="icon:image" class="uk-margin-small-right uk-text-primary uk-icon"></span>ç…§ç‰‡æ•¸é‡</span>
      <h1 class="uk-heading-primary uk-margin-remove uk-text-primary">{{ '{:,}'.format(stats.media_total ) }}</h1>
    </div>
  </div>
  <hr />
  <div class="uk-grid uk-grid-medium" data-uk-grid uk-sortable="handle: .sortable-icon">
    <!-- panel -->
    <div class="uk-width-1-2@l">
      <div class="uk-card uk-card-default uk-card-small uk-card-hover">
	<div class="uk-card-header">
	  <div class="uk-grid uk-grid-small">
	    <div class="uk-width-auto"><h4>é¤¨è—é¡åˆ¥</h4></div>
	    {#
            <div class="uk-width-expand uk-text-right panel-icons">
	      <a href="#" class="uk-icon-link sortable-icon" title="Move" data-uk-tooltip data-uk-icon="icon: move"></a>
	      <a href="#" class="uk-icon-link" title="Configuration" data-uk-tooltip data-uk-icon="icon: cog"></a>
	      <a href="#" class="uk-icon-link" title="Close" data-uk-tooltip data-uk-icon="icon: close"></a>
	    </div>
            #}
	  </div>
	</div>
	<div class="uk-card-body">
	  <div class="chart-container">
	    <canvas id="collection-chart"></canvas>
	  </div>
	</div>
      </div>
    </div>
    <!-- /panel -->
    <!-- panel -->
    <div class="uk-width-1-2@l">
      <div class="uk-card uk-card-default uk-card-small uk-card-hover">
	<div class="uk-card-header">
	  <div class="uk-grid uk-grid-small">
	    <div class="uk-width-auto"><h4>è¿‘æœŸæ–°å¢</h4></div>
            {#
	    <div class="uk-width-expand uk-text-right panel-icons">
	      <a href="#" class="uk-icon-link sortable-icon" title="Move" data-uk-tooltip data-uk-icon="icon: move"></a>
	      <a href="#" class="uk-icon-link" title="Configuration" data-uk-tooltip data-uk-icon="icon: cog"></a>
	      <a href="#" class="uk-icon-link" title="Close" data-uk-tooltip data-uk-icon="icon: close"></a>
	    </div>
            #}
	  </div>
	</div>
	<div class="uk-card-body">
	  <div class="chart-container">
	    <canvas id="created-chart"></canvas>
	  </div>
	</div>
      </div>
    </div>
    <!-- /panel -->
    <!-- panel -->
    <div class="uk-width-1-2@l">
      <div class="uk-card uk-card-default uk-card-small uk-card-hover">
	<div class="uk-card-header">
	  <div class="uk-grid uk-grid-small">
	    <div class="uk-width-auto"><h4>{{ _('å¿—å·¥è²¢ç»') }} - {{ _('æ¨™ç±¤æŠ„éŒ„æ’è¡Œæ¦œ') }}</h4></div>
	  </div>
	</div>
	<div class="uk-card-body">
          {% if stats.top_contributors %}
          <table class="uk-table uk-table-small uk-table-divider uk-table-hover">
            <thead>
              <tr>
                <th class="uk-table-shrink">{{ _('æ’å') }}</th>
                <th>{{ _('ä½¿ç”¨è€…') }}</th>
                <th class="uk-text-right">{{ _('æŠ„éŒ„æ•¸é‡') }}</th>
              </tr>
            </thead>
            <tbody>
              {% for contributor in stats.top_contributors %}
              <tr>
                <td class="uk-text-center">
                  {% if loop.index == 1 %}
                    <span class="uk-label" style="background: gold; color: #333;">ğŸ¥‡ {{ loop.index }}</span>
                  {% elif loop.index == 2 %}
                    <span class="uk-label" style="background: silver; color: #333;">ğŸ¥ˆ {{ loop.index }}</span>
                  {% elif loop.index == 3 %}
                    <span class="uk-label" style="background: #cd7f32; color: white;">ğŸ¥‰ {{ loop.index }}</span>
                  {% else %}
                    <span class="uk-text-muted">{{ loop.index }}</span>
                  {% endif %}
                </td>
                <td><strong>{{ contributor.username }}</strong></td>
                <td class="uk-text-right uk-text-bold">{{ '{:,}'.format(contributor.count) }}</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
          {% else %}
          <p class="uk-text-muted uk-text-center">{{ _('ç›®å‰æ²’æœ‰è²¢ç»è¨˜éŒ„') }}</p>
          {% endif %}
	</div>
      </div>
    </div>
    <!-- /panel -->
  </div>
</div>
{% endblock %}
